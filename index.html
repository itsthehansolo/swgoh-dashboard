<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWGHDash - Mod Management</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #0b0f19; /* Deep dark background matching the screenshots */
        }
        
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Mod status highlights adapted for dark mode */
        .mod-perfect { background-color: rgba(16, 185, 129, 0.2); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.3); }
        .mod-missing { background-color: rgba(239, 68, 68, 0.15); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.2); }
        
        .search-input:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3); }
    </style>
</head>
<body class="text-slate-300 min-h-screen">

    <div id="app" class="flex flex-col h-screen">
        <!-- Top Navigation Bar -->
        <header class="bg-[#0f172a] border-b border-slate-800 px-6 py-4 flex items-center justify-between">
            <div class="flex flex-col">
                <h1 class="text-2xl font-black text-yellow-500 tracking-tighter uppercase leading-none">SWGHDash</h1>
                <span id="build-id" class="text-[10px] text-slate-500 font-mono mt-1 uppercase tracking-widest">build_260212_234800</span>
            </div>

            <div class="flex items-center gap-6">
                <!-- Search Component -->
                <div class="relative">
                    <input 
                        type="text" 
                        id="character-search" 
                        placeholder="Search Characters..." 
                        class="search-input bg-[#1e293b] border border-slate-700 rounded px-4 py-1.5 text-sm w-64 text-slate-200 placeholder-slate-500 transition-all"
                    >
                </div>
            </div>
        </header>

        <!-- Sub-header/Breadcrumb Bar -->
        <div class="bg-[#1e293b] border-b border-slate-800 px-6 py-2">
            <nav id="menu" class="flex gap-4 text-xs font-semibold text-slate-400">
                <!-- Menu links will be injected by JS -->
            </nav>
        </div>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-auto p-6">
            <div class="bg-[#111827] rounded-lg border border-slate-800 shadow-2xl">
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse min-w-[1500px]">
                        <thead>
                            <tr class="bg-[#1f2937] text-slate-400 text-[10px] uppercase tracking-wider font-bold">
                                <th class="p-3 border-b border-slate-800">Namn</th>
                                <th class="p-3 border-b border-slate-800 text-center">Lvl</th>
                                <th class="p-3 border-b border-slate-800 text-center">Stars</th>
                                <th class="p-3 border-b border-slate-800 text-center">Gear</th>
                                <th class="p-3 border-b border-slate-800 text-center">Kyro</th>
                                <!-- Mod Columns -->
                                <th class="p-3 border-b border-slate-800 bg-slate-900/30">Mod Set</th>
                                <th class="p-3 border-b border-slate-800 italic opacity-60">Set (r)</th>
                                <th class="p-3 border-b border-slate-800">Square</th>
                                <th class="p-3 border-b border-slate-800 bg-slate-900/30">Arrow</th>
                                <th class="p-3 border-b border-slate-800 italic opacity-60">Arrow (r)</th>
                                <th class="p-3 border-b border-slate-800">Diamond</th>
                                <th class="p-3 border-b border-slate-800 bg-slate-900/30">Triangle</th>
                                <th class="p-3 border-b border-slate-800 italic opacity-60">Tri (r)</th>
                                <th class="p-3 border-b border-slate-800 bg-slate-900/30">Circle</th>
                                <th class="p-3 border-b border-slate-800 italic opacity-60">Circ (r)</th>
                                <th class="p-3 border-b border-slate-800 bg-slate-900/30">Cross</th>
                                <th class="p-3 border-b border-slate-800 italic opacity-60">Cross (r)</th>
                            </tr>
                        </thead>
                        <tbody id="unit-table-body" class="text-[13px] divide-y divide-slate-800/50">
                            <!-- Rows injected by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-[#0f172a] border-t border-slate-800 px-6 py-2 flex justify-center">
            <span class="text-[10px] text-slate-600 font-mono uppercase tracking-widest">build_260212_234800</span>
        </footer>
    </div>

    <script>
        let allUnits = []; 

        /**
         * Load data and initialize UI
         */
        async function initDashboard() {
            try {
                const response = await fetch('swgoh_data.json');
                if (!response.ok) throw new Error('Could not find swgoh_data.json');
                const data = await response.json();
                
                allUnits = data.units || [];

                // Render Navigation Menu
                const menu = document.getElementById('menu');
                data.menu?.forEach(item => {
                    const a = document.createElement('a');
                    a.href = item.url;
                    a.textContent = item.label;
                    a.className = "hover:text-blue-400 transition-colors uppercase";
                    menu.appendChild(a);
                });

                renderTable(allUnits);

                // Search handler
                document.getElementById('character-search').addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase();
                    const filtered = allUnits.filter(u => u.name.toLowerCase().includes(query));
                    renderTable(filtered);
                });

            } catch (err) {
                console.error("Init Error:", err);
                document.getElementById('unit-table-body').innerHTML = `<tr><td colspan="17" class="p-10 text-center text-red-400">Error: ${err.message}</td></tr>`;
            }
        }

        /**
         * Renders the character table
         * Compares current mod values with recommended (r) values for styling
         */
        function renderTable(units) {
            const tbody = document.getElementById('unit-table-body');
            tbody.innerHTML = '';

            units.forEach(unit => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-800/40 transition-colors border-l-2 border-transparent hover:border-yellow-500/50";

                /**
                 * Helper to calculate styling based on comparison with recommendation
                 */
                const getStyle = (current, recommended) => {
                    if (!recommended || recommended === "") return "text-slate-500";
                    if (!current || current === "") return "mod-missing rounded px-1";
                    
                    const match = current.toLowerCase().includes(recommended.toLowerCase());
                    return match ? "mod-perfect rounded px-1 font-semibold" : "mod-missing rounded px-1";
                };

                // Gear highlighting logic
                let gearStyle = "text-slate-400";
                if (unit.gear?.startsWith('R')) {
                    const rLevel = parseInt(unit.gear.replace('R', ''));
                    gearStyle = rLevel >= 7 ? "text-amber-400 font-bold" : "text-blue-400 font-bold";
                }

                // Square and Diamond speed logic
                const vSquareStyle = (unit.v_square_speed === "yes") ? "mod-perfect rounded px-1" : "text-slate-500";
                const vDiamondStyle = (unit.v_diamond_speed === "yes") ? "mod-perfect rounded px-1" : "text-slate-500";

                tr.innerHTML = `
                    <td class="p-3">
                        <a href="${unit.url}" target="_blank" class="font-bold text-slate-100 hover:text-blue-400 transition-colors">${unit.name}</a>
                    </td>
                    <td class="p-3 text-center text-slate-500 font-mono">${unit.level}</td>
                    <td class="p-3 text-center font-bold ${unit.stars === 7 ? 'text-amber-500' : 'text-slate-400'}">${unit.stars}*</td>
                    <td class="p-3 text-center ${gearStyle}">${unit.gear}</td>
                    <td class="p-3 text-center text-slate-400 font-mono">${unit.kyro || '0'}</td>
                    
                    <!-- Mod Comparison Columns -->
                    <td class="p-3 bg-slate-900/20"><span class="${getStyle(unit.set, unit['set(r)'])}">${unit.set || '-'}</span></td>
                    <td class="p-3 text-slate-500 italic text-[11px]">${unit['set(r)'] || '-'}</td>
                    
                    <td class="p-3"><span class="${vSquareStyle}">${unit.square || '-'}</span></td>
                    
                    <td class="p-3 bg-slate-900/20"><span class="${getStyle(unit.arrow, unit['arrow(r)'])}">${unit.arrow || '-'}</span></td>
                    <td class="p-3 text-slate-500 italic text-[11px]">${unit['arrow(r)'] || '-'}</td>
                    
                    <td class="p-3"><span class="${vDiamondStyle}">${unit.diamond || '-'}</span></td>
                    
                    <td class="p-3 bg-slate-900/20"><span class="${getStyle(unit.triangle, unit['triangle(r)'])}">${unit.triangle || '-'}</span></td>
                    <td class="p-3 text-slate-500 italic text-[11px]">${unit['triangle(r)'] || '-'}</td>
                    
                    <td class="p-3 bg-slate-900/20"><span class="${getStyle(unit.circle, unit['circle(r)'])}">${unit.circle || '-'}</span></td>
                    <td class="p-3 text-slate-500 italic text-[11px]">${unit['circle(r)'] || '-'}</td>
                    
                    <td class="p-3 bg-slate-900/20"><span class="${getStyle(unit.cross, unit['cross(r)'])}">${unit.cross || '-'}</span></td>
                    <td class="p-3 text-slate-500 italic text-[11px]">${unit['cross(r)'] || '-'}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        window.onload = initDashboard;
    </script>
</body>
</html>
